<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="__PUBLIC__/Css/bootstrap.css" />
<link rel="stylesheet" href="__PUBLIC__/Css/main.css" />
<script type="text/javascript" src="__PUBLIC__/Js/jquery-1.8.3.min.js"></script>
<script type="text/javascript" src="__PUBLIC__/Js/selects.js"></script>
<script type="text/javascript">
	function myrefresh(){
		window.location.reload();
	}
</script>
<style type="text/css">
    .headalign{
		text-align: left;
	}
	.btncoursetable{
		width:100px;
		text-align: left;
	}
	.numColor0{
		color: red;

	}
	.numColor1{
		color: green;
		font-size: 20px;
		font-weight: bold;
	}	
	.xiexian{
	    width:20px;
		margin-left:-5px;margin-right:-5px;
	}
	.form-inline{
		padding:5px 0px 5px 0px;
		margin:5px 0px 5px 16px;
		
		height:100px;
		line-height:34px;
	 }
	 .trColor{
	 	 background-color: #eee;
	 }
	 .btn6{
	 	 width: 120px;
	 }
</style>
</head>

<body>
<div class="panel panel-default">
	  <div class="panel-heading headalign">
		<a  class="btn  btncoursetable"><span class="glyphicon glyphicon-home"></span> 教师课表</a>
		<a href="{:U(GROUP_NAME.'/Excise/resetSX')}" class="btn btn-info btn6"><span class="glyphicon glyphicon-retweet"></span> 清除演示数据</a>(注意：请在系统部署好使用之前使用该功能！)
		<span style="float: right;">

	     	<button class="btn btn-info" onclick="myrefresh()"><span class="glyphicon glyphicon-refresh"></span> 刷新</button>
			<a href="{:U(GROUP_NAME.'/Excise/coursetableSave')}" class="btn btn-info btn4"><span class="glyphicon glyphicon-plus"></span> 添加课程</a>
	     	<div style="display: none;">如想导出，请直接选择复制下表中的数据粘贴到Excel表中即可！</div>
	     </span>
	  </div>
	  <div class="form-inline">
		<form action='{:U(GROUP_NAME.'/Excise/courseTable')}' method="post">
             <span class="bpx">
			 提示：请选择其中一种方式，然后单击查询！
			</span>
			<br/>
	  		方式一：
  			<select name="term1" class="form-control" style="width: 250px;"></select>
			<select name="coursename" class="form-control" style="width: 250px;"></select>
			<!-- js的使用 start-->
			 <script type="text/javascript" src="__PUBLIC__/Js/termCourse.js"></script>
			 <script type="text/javascript">

				var s = selects;
				//获取对象
				var a = document.getElementsByName('term1')[0];
				var b = document.getElementsByName('coursename')[0];
				//绑定数据
				s.bind(a,xq);//xq和kc来自js文件的变量
				s.bind(b,kc);//a和b来自本页面的属性
				
				//确定从属关系
				s.parent(a,b);
			 </script>
			<button type="submit" class="btn btn-default"><span class='glyphicon glyphicon-search'></span> 查询</button>
			&nbsp;&nbsp;<br/>
	  		方式二：
  			<select name="term2" class="form-control" style="width: 250px;"></select>
			<select name="js" class="form-control" style="width: 250px;"></select>
			<!-- js的使用 start-->
			 <script type="text/javascript" src="__PUBLIC__/Js/termTeacher.js"></script>
			 <script type="text/javascript">

				var s = selects;
				//获取对象
				var a = document.getElementsByName('term2')[0];
				var b = document.getElementsByName('js')[0];
				//绑定数据
				s.bind(a,xq);//xq和kc来自js文件的变量
				s.bind(b,js);//a和b来自本页面的属性
				
				//确定从属关系
				s.parent(a,b);
			 </script>
			<button type="submit" class="btn btn-default"><span class='glyphicon glyphicon-search'></span> 查询</button>
			</form>
	  </div>
	  <div class="panel-body">
		 <table class='table table-bordered table-hover'>
			<tr><td>ID</td><td>学期</td><td>任课教师</td><td>班级</td><td>课程</td><td>任务数量</td><td>操作</td></tr>
			<foreach name='coursetable' item='v'>
				<php>
			  	 $tr = substr($v['term'],10,1);
			  	</php>
				<tr <if condition="$tr eq 1"> class="trColor"</if>  >
				<td>{$v.scid}</td>
				<td>{$v.term}</td>
				<td>{$v.jsxm}</td>
				<td>{$v.cname}</td>
				<td>{$v.coursename}</td>
				<td><php>   
				        $i=0; 
						$scid = $v['scid'];
    					$pubnum = M('sxpubexcise')->where("scid=$scid")->count();
    					
    					if($pubnum>0)$i=1;
    				</php>
    				<span class="numColor{$i}">{$pubnum}</span>
    			</td>
				<td align="left">　
				   <a href="{:U(GROUP_NAME.'/Excise/sxpubexciseList',array('scid'=>$v['scid']))}" class="btn btn-default btn4" title="查看指定教师发布的指定课程的任务列表！"><span class="glyphicon glyphicon-eye-open"></span> 任务列表</a>&nbsp;
					
					<if condition=" $pubnum neq 0">
						<a href="{:U(GROUP_NAME.'/Excise/sxcoursePackage',array('scid'=>$v['scid']))}" class="btn btn-default btn4" title="将该课程所有任务和学生作业打包下载！"><span class="glyphicon glyphicon-save"></span> 资料存档</a>&nbsp;
					</if>
					
					<if condition="$pubnum eq 0">
					<a href="{:U(GROUP_NAME.'/Excise/delcourseTable',array('id'=>$v['scid']))}" class="btn btn-default" title="如果没有任务可以直接删除，否则需要删尽其下的任务再进行删除！"><span class="glyphicon glyphicon-remove"></span> 删除</a>
					</if>
				</td>
			</tr>
			</foreach>
		</table>
	  </div>
	  
</div>
</body>
</html>
